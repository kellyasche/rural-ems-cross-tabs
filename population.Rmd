---
title: "Size of population served cross-tabs"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 4
runtime: shiny
resource_files:
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.cpg
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.dbf
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.prj
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbn
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.sbx
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shp.xml
- Data/Shapefiles/County shapefiles/MNCounties_MNDOT.shx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(sf)
library(ggrepel)
library(scales)
library(shiny)
library(shinycssloaders)
library(ggiraph)
library(kableExtra)
library(rmapshaper)
library(cowplot)
library(DT)
library(htmlwidgets)
library(RColorBrewer)
library(extrafont)
library(readxl)
library(janitor)
library(lubridate)
library(gmodels)
library(infer)
library(broom)
library(crosstable)

loadfonts()
```

```{r loading jon docs and shapefiles, cache=TRUE, include=FALSE}
theme_bar <- theme_bw() +
  theme(panel.grid.major = element_line(color = "grey70", size = 0.1),
        panel.grid.minor = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.key.size = unit(1, "lines"),
        legend.margin = margin(0,0,0,0),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        text = element_text(family = "Arial"))

theme_line <- theme_bw() +
  theme(legend.background = element_rect(fill = "transparent", color = "transparent"),
        legend.key = element_rect(fill = "transparent"),
        legend.text = element_text(margin = margin(l = 2)),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_line(color = "grey70", size = 0.1),
        axis.ticks = element_blank(),
        axis.text = element_text(face = "bold"),
        panel.border = element_blank(),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial"))


theme_sf <- theme_bw() +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks=element_blank(),
        panel.background = element_blank(),
        panel.grid.major = element_line(color = "white"),
        panel.border = element_blank(),
        plot.title = element_text(hjust = 0.5),
        legend.title = element_blank(),
        legend.text = element_text(margin = margin(l = 2)),
        legend.margin = margin(0,0,0,0),
        legend.key.size = unit(1, "lines"),
        text = element_text(family = "Arial"))

regions <- read_csv("Data/Join docs/county_regions.csv") %>%
    select(5,6) %>%
    unique() %>%
    mutate(edr = str_replace(edr, "  ", " "),
           planning.region = str_replace(planning.region, " Minnesota", ""),
           planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
           edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"))

counties.regions <- read_csv("Data/Join docs/county_regions.csv") %>%
  rename(mif = `MIF Region`) %>%
  mutate(countyfp = formatC(countyfp, width = 3, flag = "0"),
         Name = str_to_title(Name),
         Name = str_replace(Name, "Q", "q"),
         Name = str_replace(Name, "Of The", "of the"),
         Name = str_replace(Name, "Mcleod", "McLeod"),
         Dem_Desc = ifelse(Name == "Minnesota", "Minnesota", Dem_Desc) ,
         edr = str_replace(edr, "  ", " "),
         planning.region = str_replace(planning.region, " Minnesota", ""),
         planning.region = fct_relevel(planning.region, "Northwest", "Northeast", "Central", "Seven County Mpls-St Paul", "Southwest", "Southeast"),
         edr = fct_relevel(edr, "EDR 1 - Northwest", "EDR 2 - Headwaters", "EDR 3 - Arrowhead", "EDR 4 - West Central", "EDR 5 - North Central", "EDR 6E- Southwest Central", "EDR 6W- Upper Minnesota Valley", "EDR 7E- East Central", "EDR 7W- Central", "EDR 8 - Southwest", "EDR 9 - South Central", "EDR 10 - Southeast", "EDR 11 - 7 County Twin Cities", "Minnesota"),
         mif = ifelse(is.na(mif), "TC", mif),
         mif = as.factor(mif),
         mif = fct_relevel(mif, "NW", "NE", "WC", "EC", "SW", "SE", "TC"))

color.ruca <- c("Entirely rural" = "#009933", "Town/rural mix" = "#99CC33", "Urban/town/rural mix" = "#CC9966", "Entirely urban" = "#754C29", "Minnesota" = "black")

color.pr <- c("Northwest" = 	"#4575b4", "Northeast" = "#e0f3f8", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black")

color.edr <- c("EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365", "Minnesota" = "black")

color.pr.edr <- c ("Northwest" = "#4575b4","Northeast" = "#e0f3f8", "Central" = "#fee090", "Seven County Mpls-St Paul" = "#d73027", "Southwest" = "#91bfdb", "Southeast" = "#fc8d59", "Minnesota" = "black", "EDR 1 - Northwest" = "#b3cde3", "EDR 2 - Headwaters" = "#8c96c6", "EDR 3 - Arrowhead" = "#fe9929", "EDR 4 - West Central" = "#8856a7", "EDR 5 - North Central" = "#810f7c", "EDR 6E- Southwest Central" = "#e5f5f9", "EDR 6W- Upper Minnesota Valley" = "#bdc9e1", "EDR 7E- East Central" = "#99d8c9", "EDR 7W- Central" = "#2ca25f", "EDR 8 - Southwest" = "#74a9cf", "EDR 9 - South Central" = "#0570b0", "EDR 10 - Southeast" = "#d7301f", "EDR 11 - 7 County Twin Cities" = "#d8b365")

mn_counties <- st_read("Data/Shapefiles/county shapefiles/MNCounties_MNDOT.shp", quiet = TRUE) %>%
  ms_simplify(keep = .01, keep_shapes = TRUE) %>%
  rename(countyfp = FIPS_CODE)

```

```{r master response, include=FALSE, cache=TRUE}
master.responses <- read_csv("Data/Responses/Master-survey-responses.csv") %>%
  mutate(region = fct_relevel(region, "Northeast", "Northwest", "West Central", "Central", "Southwest", "South Central", "Southeast")) %>%
  rename(public.or.private = 4) %>%
  mutate(public.or.private = str_replace(public.or.private, "Public owned or operated \\(e.g. city, county authority or joint powers board\\)", "Public owned or operated"),
         public.or.private = str_replace(public.or.private, "Private or other non-profit owned or operated", "Private or non-profit"),
         public.or.private = as.factor(public.or.private)) %>%
  rename(corp.sup = 9,
         pop = 3) %>%
  mutate(pop = as.factor(pop),
         pop = fct_relevel(pop, "Less than 2,500", "2,500 – 4,999", "5,000 – 9,999", "10,000 – 14,999", "15,000 or greater"))

names(master.responses)
levels(master.responses$pop)
```

This section of analysis examines whether there was a relationship between the size of the population served by an agency and how an agency responded to questions in the survey. The population question was was;

**What is the estimated total population that you serve?**

Respondents were provided the following options;

* Less than 2,500 (24.7%, 46)
* 2,500 - 4,999 (30.7%, 57)
* 5,000 - 9,999 (15.1%, 28)
* 10,000 - 14,999 (11.8%, 22)
* Greater than 15,000 (14.5%, 27)

The metro response was eliminated from analysis.

The survey was broken into 7 different sections. The three sections in bold is what was included  in the analysis due to the MN Department of Health providing incomplete data. You can navigate to the analysis of any of these sections using the table of contents on the left-hand side. The sections are.

1. **Characteristics questions**
2. **Workforce sustainability questions**
3. **Leadership questions**
4. Education questions
5. Medical direction questions
6. Community relation questions
7. Funding questions

The analysis used for the cross tabs is the typical chi-square test with p-value.

<br>

# Summary of results{.tabset}

The tabs below lists which questions showed a relationship to the size of the population served by an agency and combines the executive summary from the MN Department of Health's analysis with the relationships found in this analysis.

<br>

## Questions with relationships

The following are the questions that showed a statistical significance indicating a relationship were; 

* Characteristics section
  + What type of services do you provide?
  + How are staff compensated, not including the agency director?
  + Are you using Emergency Medical Responders (EMRs) to routinely staff your ambulance(s)?

* Workforce sustainability section
  + Do you have enough people to cover your cal schedule without undue burden or excessive time commitments?
  + Is it difficult to recruit new EMS staff?
  + Are any EMS staff cross-trained to work in police, fire, or other public service functions?
  + Which of the following items are obstacles to recruiting EMS staff for your agency? - lack of availability
  + Which of the following items are obstacles to recruiting EMS staff for your agency? - training requirements are too time consuming
  + Which of the following items are obstacles to recruiting EMS staff for your agency? - inadequate pay
  + Which of the following items are obstacles to recruiting EMS staff for your agency? - time commitment is too great
  + Which of the following items are obstacles to recruiting EMS staff for your agency? - child care responsibilities
  + Does your EMS agency have a retention strategy?
  + Which of the following items are obstacles to retaining staff for your agency? - age: older crew members retiring
  + Which of the following items are obstacles to retaining staff for your agency? - excessive time commitment or scheduling conflicts
  + Which of the following items are obstacles to retaining staff for your agency? - limited advancement opportunities
  + Which of the following items are obstacles to retaining staff for your agency? - employer does not allow staff to leave work for a call
  
* Leadership section
  + Has the EMS manager of your agency had formal leadership or management training?
  + Which areas are most difficult to manage? - recruitment
  + Which areas are most difficult to manage? - retention
  + Which areas are most difficult to manage? - staffing the schedule
  + Which areas are most difficult to manage? - none

<br>

## Addition to MN Department of Health Summary

The following narrative combines the executive summary from the MN Department of Health's aggregate analysis of the survey with the relationships found in this analysis. Hopefully this will round out the results a bit better and point to more specific trends within the results.

<br>

### Characteristics section{.unnumbered .unlisted .toc-ignore}

**Key Findings**

Most rural EMS agencies provide basic life support services to relatively small populations spread across large geographic areas. Along with low daily call volumes, these realities exacerbate the inability to create sustainable business and staffing models.

* The median call volume is nearly one call per day
* Over half of the agencies cover more than 200 square miles; 37 percent cover more than 300
square miles
* Over half of the agencies serve populations of less than 5,000

However, it is worth noting that there were some differences in responses depending on whether they were owned, managed or received support from a corporate health system. 

* *Types of services provided: * although a very large percentage of agencies responded that they provide basic life support (88.2% of total responses), agencies that serve small populations responded that they provide basic life support at a significantly higher rate than other agencies - 96% of responses (Less than 2,500) and 98% of responses (2,500 - 4,999). On the flip side, agencies that serve large populations were significantly more likely to provide advanced life support - 63% of responses (10,000 - 14,999) and 92% of responses (greater than 15,000). Agencies that serve moderately sized populations (5,000 - 9,999) were significantly more likely to respond that they provided part-time advanced life support - 47% of responses.
* *Staff compensation: * although a majority of agencies responded that they pay their staff using a volunteer / on call compensation structure (57% of total responses), agencies that serve larger populations were significantly more likely to pay their staff - 84% of responses from agencies serving greater than 15,000.
* *Using EMRs to staff ambulance: * Although a majority of agencies (59% of total responses) responded that they do NOT use EMRs to staff their ambulance(s), agencies that serve small populations were significantly more likely to use EMRs to staff ambulances - 65% of agencies serving less than 2,500 and 51% of agencies serving 2,500 - 4,999.

<br>

### Workforce sustainability section{.unnumbered .unlisted .toc-ignore}

**Key Findings**

Staffing shortages are a major challenge for rural EMS agencies. Eighty (80) percent utilize some version of volunteers to staff their operations. Roster sizes are decreasing, many staff are trained for multiple public functions and many call schedules are not covered 24 hours prior to the shifts.

* The active staff roster decreased for half of the agencies from the previous year
* Weekday daytime hours are the most difficult shifts to cover. However, all weekend and holiday
shifts are also difficult to cover
* About 60 percent of agencies have inadequate staff to cover their call schedule without undue
burden to the agency.
* Fifty-nine (59) percent of agencies do not have their shifts 100 percent covered at least 24 hours in
advance

Recruitment and retention of ambulance personnel continues to be a significant challenge even though:
* Emergency Medical Responders (EMRs) are now widely used to actively staff rural EMS agencies
* Most agencies cover the full cost of the continuing education courses for their staff
* Most eligible recipients take advantage of state EMS training reimbursement

However, it is worth noting that there were some differences in responses depending on whether or not an agency was owned, manged or receives support from a corporate health system. 

* *Difficult to recruit new staff: * Although a majority of agencies (63%) said that staff recruitment was difficult, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (68% vs. 48%). 
* *Cross-training of EMS staff: * Although a large majority of agencies (74%) said that their EMS staff were cross-trained in other publicly safety positions, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (83% vs. 52%). 
* *Obstacles to recruiting - training requirements: * Although a majority of agencies (58%) responded that training requirements being too time consuming was a barrier to staff recruitment, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (67% vs. 35%).
* *Obstacles to recruiting - time commitment is too great: * Although a majority of all agencies (67%) responded that the time commitment being too great as a barrier to staff recruitment, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (77% vs. 44%). 
* *Obstacles to recruiting - child care responsibilities: * Although only 38% of all agencies said that child care responsibilities were a barrier to staff recruitment, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (55% vs. 21%).
* *Agency have a retention strategy: * Half of all agencies responded that they have a retention strategy, however agencies that are owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (69% vs. 44% respectively).
* *Obstacles to retention - retirements: * Although a large majority of agencies responded that age/retirements was a barrier to staff retention, agencies that are NOT owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (67% vs. 44%). 
* *Obstacles to retention - excessive time commitment: * Although a large majority of all agencies said that the excessive time commitment or scheduling conflicts were a barrier to staff retention, agencies that are NOT owned, managed or receive support from a corporate health systyem responded this way at a significantly higher rate than other agencies (82% vs. 50%)
* *Obstacles to retention - limited advancement opportunities: * Although only 23% of all agencies said that limited advancement opportunities were a barrier to staff retention, agencies that are owned, managed or receive support from a corporate health system confirmed this barrier at a significantly higher rate than other agencies (44% vs. 16%).
* *Obstacles to retention - employer not allowing staff to leave: * Although only 37% of all agencies said that employers not allowing staff to leave work for a call was a barrier to staff retention, agencies that are NOT owned, managed or receive support from a corporate health system confirmed this barrier at a significantly higher rate than other agencies (44% vs. 21%).

<br>

### Leadership section{.unnumbered .unlisted .toc-ignore}

**Key Findings**

The largest problems that rural EMS agency managers face today, as in the past, are recruitment of staff and filling call schedules. These two management tasks seem to form a Maslow’s Hierarchy of basic management needs (see Appendix C, Question 24). It may be that efforts to address other management issues will be fruitless and/or unwelcomed until these basic needs are addressed.

* Sixty-nine (69) percent of rural EMS managers report difficulty recruiting staff despite the fact that 57.5 percent have a recruitment plan
* Over half of rural EMS managers report difficulty staffing their schedule

High leadership turnover was defined in this survey as an EMS agency having had three or more managers in the past five years. Using this definition, there is remarkably low turnover of rural EMS managers. A high majority of EMS managers have an active role in developing their budgets, but generally are not directly involved in billing.

* Eighty-six (86) percent of services did not have high turnover of their managers
* Eighty-one (81) percent of rural EMS managers have a role in developing their annual budgets
* Eighty-one (81) percent use other resources to bill, with billing agencies as the most common at
fifty-two (52) percent

However, it is worth noting that there was one difference in responses depending on whether or not an agency was owned, managed or receives support from a corporate health system. 

* *Management received training: * Although a majority of agencies (54%) responded that their management has received formal leadership or management training, agencies that are owned, managed or receive support from a corporate health system responded this way at a significantly higher rate than other agencies (77% vs. 46%).

<br>

# Characteristics section analysis{.tabset}

The questions where the size of the population served had a relationship with responses to the questions in the demographic section of the survey are summarized below.

**Summary:** 

*Services provided:*
Agencies that serve larger populations were significantly more likely to provide advanced life support. Agencies that serve a moderate population size were significantly more likely to provide part-time advanced life support. And agencies that serve smaller population sizes were significantly more likely to provide basic life support.

*Staff compensation*
Agencies that serve larger populations were significantly more likely to pay their staff. Agencies that serve moderate population sizes were significantly more likely to rely on a combination of paid and volunteer staff. And agencies that serve a small population size were significantly more likely to use an on-call compensation structure.

*Using EMS to staff ambulances*
Agencies that serve smaller population sizes were significantly more likely to utilize EMS to staff their ambulances.


<br>

## Services provided{.tabset .tabset-pills}

**What types of services do you provide?**

This question provided 4 choices which are provided below in order of the top one receiving the most responses;

* Basic Life Support (88%)
* Advacned life support (27%)
* Part-time advanced life support (17%)
* Specialized advanced life support (9%)

<br>

```{r prep pop served and services provided}
pop.services <- master.responses %>%
  select(3, 10:13) %>%
  gather(key = "services", value = "provided", 2:5) %>%
  mutate(provided = as_factor(provided),
         services = str_replace(services, "ServicesProvided \\(Q11_1\\)", "Basic life support"),
         services = str_replace(services, "ServicesProvided \\(Q11_2\\)", "Advanced life support"),
         services = str_replace(services, "ServicesProvided \\(Q11_3\\)", "Part-time advanced life support"),
         services = str_replace(services, "ServicesProvided \\(Q11_4\\)", "Specialized life support"),
         services = as.factor(services),
         provided = ifelse(provided == "-", "No", "Yes"))

pop.als <- pop.services %>%
  filter(services == "Advanced life support")

pop.bls <- pop.services %>%
  filter(services == "Basic life support")

pop.parttime.als <- pop.services %>%
  filter(services == "Part-time advanced life support")

pop.sls <- pop.services %>%
  filter(services == "Specialized life support")

```

### Advanced life support

There is a relationship in the size of the population served and whether an agency provided advanced life support.

It's clear that the higher the population served, the higher the response rate was that agencies provided advanced life support.

* Less than 2,500: 2 responses (4%) vs. 12 expected (27%)
* 2,500 - 4,999: 2 responses (4%) vs. 15 expected (27%)
* 5,000 - 9,999: 6 responses (20%) vs. 8 expected (27%)
* 10,000 - 14,999: 15 responses (63%) vs. 6 expected (27%)
* Greater than 15,000: 24 responses (92%) vs. 7 expected (27%)


<br>

```{r advanced life support contingency table}

CrossTable(pop.als$pop, pop.als$provided, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Basic life support

There is a relationship in the size of the population served and whether an agency provides basic life support.

This is basically the same as the advanced life support but in the opposite direction (albeit slightly lower difference). The lower the population, the higher rate of responses that they provided basic life support.

* Less than 2,500: 44 responses (96%) vs. 41 expected (88%)
* 2,500 - 4,999: 56 responses (98%) vs. 51 expected (88%)
* 5,000 - 9,999: 27 responses (90%) vs. 27 expected (88%)
* 10,000 - 14,999: 19 responses (79%) vs. 22 expected (88%)
* Greater than 15,000: 19 responses (73%) vs. 23 expected (88%)

This relationship isn't nearly as strong as the previous question about advanced life support.

<br>

```{r basic life support contingency table}

CrossTable(pop.bls$pop, pop.bls$provided, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Part-time Advanced life support

There is a relationship in whether an agency offers part-time life support and the size of the population served.

For this relationship, the moderate population level had the highest. Essentially, the lower populations offer basic life support at a higher level, the moderate population served are able to at least offer part-time advanced life support, and the highest population served offers full-time advanced life support.

* Less than 2,500: 4 responses (9%) vs. 8 expected (17%)
* 2,500 - 4,999: 2 responses (4%) vs. 10 expected (17%)
* 5,000 - 9,999: 14 responses (47%) vs. 5 expected (17%)
* 10,000 - 14,999: 6 responses (25%) vs. 4 expected (17%)
* Greater than 15,000: 7 responses (27%) vs. 5 expected (17%)


<br>

```{r part-time advanced life support contingency table}

CrossTable(pop.parttime.als$pop, pop.parttime.als$provided, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Staff compensation

**How are staff compensated, not including the agency director?**

Respondents were provided 4 choices which are provided below and ranked with top choice receiving the most responses;

* Volunteer, on call compensation (57%)
* Paid, hourly wage or salary (20%)
* Combination, volunteer and paid (17%)
* Volunteer, no compensation (5%)

There is a relationship in the type of compensation provided and the size of the population served.

The main relationship is that the larger the population served the higher rate in which agencies paid their staff.

* Less than 2,500: 3 responses (7%) vs. 10 expected (20%)
* 2,500 - 4,999: 1 response (2%) vs. 12 expected (20%)
* 5,000 - 9,999: 3 responses (10%) vs. 6 expected (20%)
* 10,000 - 14,999: 9 responses (38%) vs. 5 expected (20%)
* Greater than 15,000: 22 responses (84%) vs. 5 expected (20%)

The lower the population served, the more likely an agency compensated based on on-call structures of volunteers.

Moderate size populations served were much more liekly to have a combination of paid and volunteers.

<br>

```{r pop served and compensation}
pop.comp <- master.responses %>%
  select(3,14) %>%
  rename(compensation = 2) %>%
  mutate(compensation = str_replace(compensation, "Combination of volunteer and paid staff", "Paid and vol"),
         compensation = str_replace(compensation, "Paid; hourly wage or salary", "Paid"),
         compensation = str_replace(compensation, "Volunteer \\(receive no compensation at all\\)", "Vol"),
         compensation = str_replace(compensation, "Volunteer/Paid; on-call compensation \\(on-call compensation\\); meets statutory definition of volunteer https://www.revisor.mn.gov/statutes/\\?id=144E.001#stat.144E.001.15", "On-call"),
         compensation = as.factor(compensation))

CrossTable(pop.comp$pop, pop.comp$compensation, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE, max.width = 2)
  

```

<br>


## Using EMS to staff ambulances

**Are you using Emergency Medical Responders (EMRs) to routinely staff your ambulance(s)?**

Respondents were provided two choices which are provided below in order of the selection with the most responses on top; note: it was incorrect in their report. The answers were flipped.

* Yes (41%)
* No (59%)

There is a significant relationship in whether an agency uses EMS to staff their ambulance and the size of the population served.

Agencies that serve a smaller population were significantly more likely to use EMS to staff their ambulances.

* Less than 2,500: 30 responses (65%) vs. 19 expected (41%)
* 2,500 - 4,999: 29 responses (51%) vs. 24 expected (41%)
* 5,000 - 9,999: 13 responses (43%) vs. 13 expected (41%)
* 10,000 - 14,999: 4 responses (17%) vs. 10 expected (41%)
* Greater than 15,000: 1 responses (4%) vs. 11 expected (41%)


<br>

```{r pop served and ems for staffing}
pop.ems <- master.responses %>%
  select(3,21) %>% 
  rename(ems.use = 2) 
  
CrossTable(pop.ems$pop, pop.ems$ems.use, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
  

```

<br>

## Compensation comparison

**How does you compensation for EMS staff compare with other public safety agencies in your community?**

Respondents were provided 4 choices, which are listed below in order of the top choice on top;

* Worse (33%)
* Same (29%)
* Unknown (24%)
* Better (13%)

There is no relationship in compensation comparison and the size of the population served by an agency.


<br>

```{r pop served and compensation comparison for staffing}
pop.comp.comp <- master.responses %>%
  select(3,22) %>%
  rename(comp.comp = 2) 

CrossTable(pop.comp.comp$pop, pop.comp.comp$comp.comp, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
  

```

<br>

# Workforce sustainability section analysis{.tabset}

The questions in the workforce sustainability section of the survey where the size of the population served by an agency had a relationship in how an agency responded are summarized below.

**Summary:**

*Covering the call schedule:*
Agencies that serve are larger population were significantly more likely to have their call schedule covered. Agencies serving moderate size populations were least likely.

*Difficult to staff recruitment:* 
The smaller the population served by an agency the significantly more likely it has trouble recruiting staff.

*Cross-training of staff*
Agencies that serve a smaller population were significantly more likely to have staff cross-trained in other public safety agencies.

*Obstacles to recruiting:* 
The following obstacles showed a relationship.

* Lack of availability: Agencies that serve a more moderate sized population (2,500 - 10,000) were significantly more likely to say that lack of availability was a barrier to staff recruitment.

* Training takes too much time: As the size of the population served decreases it's significantly more likely that an agency says training requirements taking too much time are a barrier to staff recruitment.

* Inadequate pay: Agencies that serve a moderate population size (2,500 - 10,000) were significantly more likely to say that inadequate pay is a barrier to staff recruitment.

* Too much time commitment: Agencies that serve a moderate size population (2,000 - 10,000) were significantly more likely to say that time commitment was a barrier to staff recruitment.

* Child care obligations: Agencies that serve the largest size population (greater than 15,000) were significantly LESS likely to say that child care obligations were a barrier to staff recruitment.


*Retention strategy:*
Agencies that serve large populations are significantly more likely to have developed a staff retention strategy.

*Obstacles to retention:* 
The following obstacles shows a relationship.

* Age: older crew members retiring: As an agency serves a smaller population the likelihood of are and retirement being a barrier to staff retention increase significantly.

* Time commitment: Agencies that serve small or moderate sized populations were significantly more likely to say that the excessive time commitment was a barrier to staff retention.

* Limited advancement: As the population served increases so does the likeliness that an agency says limited advancement is a barrier to staff retention.

* Employer won't allow staff to leave work: Agencies that serve moderately sized populations (2,500 - 10,000) were significantly more likely to respond that employers not allowing staff to leave work was a barrier to staff retention.

<br>

**Analysis:**

The questions in the workforce sustainability section of the survey are provided in tabs below along with the chi-square and p-value for the relationship between region and each question.

<br>

## Cover call schedule

**Do you have enough people to cover your call schedule without undue burden or excessive time commitments?**

Respondents were provided with two choices which are provided below in order of top choice listed first;

* No (60%)
* Yes (40%)

There is a relationship in the size of population served by an agency and whether they had their call schedule covered.

Although not as clear cut as other relationships, the higher the population served the more likely they had their call schedule covered.

* Less than 2,500: 18 responses (39%) vs. 18 expected (40%)
* 2,500 - 4,999: 15 responses (26%) vs. 23 expected (40%)
* 5,000 - 9,999: 8 responses (27%) vs. 12 expected (40%)
* 10,000 - 14,999: 16 responses (67%) vs. 10 expected (40%)
* Greater than 15,000: 16 responses (62%) vs. 10 expected (40%)

<br>

```{r pop served and covering all schedule}
pop.schedule <- master.responses %>%
  select(3,23) %>%
  rename(cover.sched = 2) 

CrossTable(pop.schedule$pop, pop.schedule$cover.sched, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Roster changes

**Over the past year, has the number of actie staff on your roster changed?**

Respondents were provided three choices which are provided below in order of top choice listed first;

* Decreased (50%)
* Same (29%)
* Increased (21%)

There is no relationship in changes to roster at an agency and the size of the population they served.

<br>

```{r pop served and roster changes}

pop.rost <- master.responses %>%
  select(3,24) %>%
  rename(rost.changes = 2) %>%
  mutate(rost.changes = str_replace(rost.changes, "Size of the active staff has not changed", "No change"),
         rost.changes = as.factor(rost.changes))

CrossTable(pop.rost$pop, pop.rost$rost.changes, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
  

```

<br>

## Recruitment plan

**Does you agency have a recruitment plan?**

Respondents were provided two choices which are provided below in order of top choice listed first;

* Yes (58%)
* No (41%)

There is no relationship in whether an agency has a recruitment plan and the size of the population they serve.

<br>

```{r pop served and recruitment plan}

pop.rec.plan <- master.responses %>%
  select(3,25) %>%
  rename(rec.plan = 2) 

CrossTable(pop.rec.plan$pop, pop.rec.plan$rec.plan, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
  

```

<br>

## Difficult to recruit?

**Is it difficult to recruit new EMS staff?**

Respondents were provided three choices which are list below with the top choice first;

* Yes (63%)
* No (4%)
* Sometimes (33%)

There is a relationship in whether an agency feels it's difficult to recruit new staff and the size of the population they serve.

The smaller the population served the more likely that an agency responded that it was difficult to recruit staff.

* Less than 2,500: 32 responses (70%) vs. 29 expected (63%)
* 2,500 - 4,999: 44 responses (77%) vs. 36 expected (63%)
* 5,000 - 9,999: 18 responses (60%) vs. 19 expected (63%)
* 10,000 - 14,999: 11 responses (46%) vs. 15 expected (63%)
* Greater than 15,000: 11 responses (42%) vs. 16 expected (63%)

It's also worth noting that all the responses saying it isn't difficult to recruit new staff came from agencies that serve populations of 15,000 or greater.

<br>

```{r pop served and difficult to recruit}

pop.dif.rec <- master.responses %>%
  select(3,26) %>%
  rename(dif.rec = 2) 

CrossTable(pop.dif.rec$pop, pop.dif.rec$dif.rec, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
  
```

<br>

## Cross-training of staff

**Are any EMS staff cross-trained to work in police, fire, or other public service functions?**

Respondents were provided two choices which are listed below with the top choice first;

* Yes (74%)
* No (25%)

There is a relationship in whether an agency has staff cross-trained in other public emergency agencies and the size of the population they serve.

Agencies that serve a smaller population were significantly more likely to have their staff cross-trained.

* Less than 2,500: 42 responses (91%) vs. 35 expected (74%)
* 2,500 - 4,999: 45 responses (79%) vs. 43 expected (74%)
* 5,000 - 9,999: 23 responses (79%) vs. 22 expected (74%)
* 10,000 - 14,999: 16 responses (67%) vs. 18 expected (74%)
* Greater than 15,000: 10 responses (40%) vs. 19 expected (74%)

<br>

```{r pop served and cross-training}

pop.cross.train <- master.responses %>%
  select(3,27) %>%
  rename(cross.train = 2) 

CrossTable(pop.cross.train$pop, pop.cross.train$cross.train, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Obstacles to recruiting{.tabset .tabset-pills}

**Which of the following items are obstacles to recruiting EMS staff for your agency?**

Respondents were provided 10 choices of which they coud select all that applied. The choices are provided below and in order with top choice listed first;

* Time commitment is too great (67%)
* Lack of availability (62%)
* Training requirements are too time consuming (58%)
* Lack of trained candidates (50%)
* inadequate pay or benefits (40%)
* Child care responsibilities (38%)
* Training requirements are too far away (23%)
* Too few runs or transports (14%)
* Too many runs or transports (9%)
* Other (5%)

There was a relationship between type of ownership and the following barriers to recruitment;

* Lack of availability
* Inadequate pay
* Training takes too much time
* Too much time commitment
* Child care obligations

<br>

```{r prep pop served and obstables to recruiting, include=FALSE, cache=TRUE}

pop.obs.rec <- master.responses %>%
  select(3,28:38) %>%
  rename(lack.interest = 2,
         lack.availability = 3,
         lack.trained.cand = 4,
         training.too.time = 5,
         training.too.exp = 6,
         training.too.dist = 7,
         inadequate.pay = 8,
         too.few.runs = 9,
         too.many.runs = 10,
         too.time.commit = 11,
         child.care = 12) %>%
  gather(key = "obstacle", value = "response", 2:12) %>%
  mutate(response = ifelse(response == "-", "No", "Yes"))
```

### Lack of interest

There is no relationship between the size of population served by an agency and whether lack of interest is considered an obstacle to recruitment.

<br>

```{r pop served and obstables to recruiting - lack of interest}
pop.obs.rec.int <- pop.obs.rec %>%
  filter(obstacle == "lack.interest")

CrossTable(pop.obs.rec.int$pop, pop.obs.rec.int$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Lack of availability

There is a between the size of the population served by an agency and whether lack of availability was considered an obstacle to recruitment.

The more moderate size of the population served the more likely an agency responded that lack of availability was considered an obstacle to recruitment. The highest rates were 

* Less than 2,500: 27 responses (59%) vs. 29 expected (62%)
* 2,500 - 4,999: 42 responses (74%) vs. 36 expected (62%)
* 5,000 - 9,999: 26 responses (87%) vs. 19 expected (62%)
* 10,000 - 14,999: 10 responses (42%) vs. 15 expected (62%)
* Greater than 15,000: 10 responses (39%) vs. 16 expected (62%)

<br>

```{r pop served and obstables to recruiting - lack of availability}
pop.obs.rec.availability <- pop.obs.rec %>%
  filter(obstacle == "lack.availability")

CrossTable(pop.obs.rec.availability$pop, pop.obs.rec.availability$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Lack of trained candidates

There is no relationship between the size of the population served by an agency and whether there is a lack of trained candidates acting as an obstacle to recruitment.

<br>

```{r pop served and obstables to recruiting - lack of candidates}
pop.obs.rec.trained.cand <- pop.obs.rec %>%
  filter(obstacle == "lack.trained.cand")

CrossTable(pop.obs.rec.trained.cand$pop, pop.obs.rec.trained.cand$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Training takes too much time

There is a relationship between the size of population served by an agency and whether training takes too much time and acts as an obstacle to recruitment.

The smaller the population served the significantly more likely an agency responded that training requirements taking too much time were a barrier to staff recruitment.

* Less than 2,500: 36 responses (78%) vs. 26 expected (58%)
* 2,500 - 4,999: 41 responses (72%) vs. 32 expected (58%)
* 5,000 - 9,999: 14 responses (47%) vs. 17 expected (58%)
* 10,000 - 14,999: 11 responses (46%) vs. 14 expected (58%)
* Greater than 15,000: 2 responses (8%) vs. 15 expected (58%)


<br>

```{r pop served and obstables to recruiting - training too much time}
pop.obs.rec.training.time <- pop.obs.rec %>%
  filter(obstacle == "training.too.time")

CrossTable(pop.obs.rec.training.time$pop, pop.obs.rec.training.time$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Training too expensive

There is no relationship between the size of the population served by an agency and whether trainings being too expensive was an obstacle to recruitment.

<br>

```{r pop served and obstables to recruiting - training too expensive}
pop.obs.rec.training.exp <- pop.obs.rec %>%
  filter(obstacle == "training.too.exp")

CrossTable(pop.obs.rec.training.exp$pop, pop.obs.rec.training.exp$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Training locations too far

There is no relationship between the size of the population served by an agency and whether trainings were too far to travel were obstacles to recruitment.

<br>

```{r pop served and obstables to recruiting - training too far}
pop.obs.rec.trainings.too.far <- pop.obs.rec %>%
  filter(obstacle == "training.too.dist")

CrossTable(pop.obs.rec.trainings.too.far$pop, pop.obs.rec.trainings.too.far$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Inadequate pay

There is a relationship  between the size of the population served by an agency and whether inadequate pay was an obstacle to recruitment.

The more moderate size of populations served were significantly more likely to respond that inadequate pay was a barrier to staff recruitment.

* Less than 2,500: 12 responses (26%) vs. 18 expected (40%)
* 2,500 - 4,999: 30 responses (53%) vs. 22 expected (40%)
* 5,000 - 9,999: 16 responses (53%) vs. 12 expected (40%)
* 10,000 - 14,999: 9 responses (38%) vs. 9 expected (40%)
* Greater than 15,000: 5 responses (19%) vs. 10 expected (40%)

<br>

```{r pop served and obstables to recruiting - inadequate pay}
pop.obs.rec.inadequate.pay <- pop.obs.rec %>%
  filter(obstacle == "inadequate.pay")

CrossTable(pop.obs.rec.inadequate.pay$pop, pop.obs.rec.inadequate.pay$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Too few runs

There is no relationship between the size of population served by an agency and whether too few runs is an obstacle to recruitment.

<br>

```{r pop served and obstables to recruiting - too few runs}
pop.obs.rec.too.few.runs <- pop.obs.rec %>%
  filter(obstacle == "too.few.runs")

CrossTable(pop.obs.rec.too.few.runs$pop, pop.obs.rec.too.few.runs$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>


There is no relationship between the size of the population served by an agency and whether too many runs was an obstacle in recruitment.

<br>

```{r pop served and obstables to recruiting - too many runs}
pop.obs.rec.too.many.runs <- pop.obs.rec %>%
  filter(obstacle == "too.many.runs")

CrossTable(pop.obs.rec.too.many.runs$pop, pop.obs.rec.too.many.runs$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Too much time commitment

There is a relationship between the size of the population served by an agency and whether too much of a time commitment was an obstacle to recruitment.

The more moderate size of the population served the more significantly more likely an agency responded that time commitment was a barrier to staff recruitment.

* Less than 2,500: 32 responses (70%) vs. 31 expected (67%)
* 2,500 - 4,999: 44 responses (77%) vs. 38 expected (67%)
* 5,000 - 9,999: 26 responses (87%) vs. 20 expected (67%)
* 10,000 - 14,999: 14 responses (58%) vs. 16 expected (67%)
* Greater than 15,000: 7 responses (27%) vs. 18 expected (67%)

<br>

```{r pop served and obstables to recruiting - too much time commitment}
pop.obs.rec.too.much.time <- pop.obs.rec %>%
  filter(obstacle == "too.time.commit")

CrossTable(pop.obs.rec.too.much.time$pop, pop.obs.rec.too.much.time$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

### Child care obligations

There is a relationship between the size of the population served by an agency and whether child care obligations were an obstacle to recruitment.

There are two population size groups that are leading this p-value. The agencies that served populations 5,000 - 9,999 (signifincantly more likely to respond this as an obstacle) and greater than 15,000 (significantly less likely to respond this as an obstacle).

* Less than 2,500: 19 responses (41%) vs. 19 expected (38%)
* 2,500 - 4,999: 24 responses (42%) vs. 23 expected (38%)
* 5,000 - 9,999: 20 responses (67%) vs. 12 expected (38%)
* 10,000 - 14,999: 10 responses (42%) vs. 10 expected (38%)
* Greater than 15,000: 1 responses (4%) vs. 11 expected (38%)

Agencies that do receive support responded that child care obligations were a barrier to recruitment at a lower rate than expected - 11 responses (21%) vs. 21 expected (38%). 

Agencies that do NOT receive support responded that child care obligations were a barrier to recruitment at a higher rate than expected - 65 responses (48%) vs. 55 expected (38%).

<br>

```{r pop served and obstables to recruiting - child care}
pop.obs.rec.child.care <- pop.obs.rec %>%
  filter(obstacle == "child.care")

CrossTable(pop.obs.rec.child.care$pop, pop.obs.rec.child.care$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Retention strategy

**Does your EMS agency have a retention strategy?**

Respondents were given two options which are provided below in order of top choice first;

* Yes (50%)
* No (49%)

There is a relationship between the size of the population served by an agency and whether an agency has a retention strategy. 

The larger the population served by an agency the significantly more likely they had developed a retention strategy.

* Less than 2,500: 17 responses (39%) vs. 22 expected (50%)
* 2,500 - 4,999: 25 responses (44%) vs. 29 expected (50%)
* 5,000 - 9,999: 12 responses (40%) vs. 15 expected (50%)
* 10,000 - 14,999: 17 responses (71%) vs. 12 expected (50%)
* Greater than 15,000: 21 responses (81%) vs. 13 expected (50%)


<br>

```{r pop served and retention strategy}
pop.retention.strat <- master.responses %>%
  select(3,41) %>%
  rename(retention.strat = 2)

CrossTable(pop.retention.strat$pop, pop.retention.strat$retention.strat, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

## Trouble retaining staff

**Does your agency have difficulty retaining existing staff?**

Respondents were provided three choices which are below in order of top choice listed first;

* Sometimes (84%)
* Always (10%)
* Never (5%)

There is no relationship between the size of the population served by an agency and whether they were having difficulty retaining staff. 

<br>

```{r pop served and difficulty retaining staff}
pop.retaining.staff <- master.responses %>%
  select(3, 42) %>%
  rename(retaining.staff = 2)

CrossTable(pop.retaining.staff$pop, pop.retaining.staff$retaining.staff, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Obstacles to retaining{.tabset .tabset-pills}

**Which of the following items are obstacles to retaining staff for your agency?**

This question provided a number of choices for an agency to select and were allowed to check all that apply. The choices are provided below in order of the choice receiving the most responses at the top and working our way down. The value in parenthesis is the percentage of responses it received.

* Excessive time commitment or scheduling conflicts (72%)
* Age: older crew members retiring (60%)
* Inadequate pay or benefits (39%)
* Employer does not allow staff to leave work for a call (37%)
* Certification is too difficult to maintain (26%)
* Limited advancement opportunities (23%)
* Lack of recognition (14%)
* Too many runs or transports (11%)
* Community is too isolated (10%)
* Other (10%)
* Too few runs or transports (10%)
* Dissatisfaction with EMS administrator/owner (5%)
* Dissatisfaction with job duties (3%)
* Dissatisfaction with EMS manager (1%)


The following barriers had a relationship to the size of the population served by an agency;

* Age: older crew members retiring
* Time commitment
* Limited advancement
* Employer won't allow staff to leave work

<br>

```{r prep pop support and obstacles to retention, include=FALSE, cache=TRUE}
pop.retention.obstacles <- master.responses %>%
  select(3,43:55)  %>%
  rename(retirement = 2,
         time.committment = 3,
         certification.maintain = 4,
         inadequate.pay = 5,
         limited.advancement = 6,
         lack.recognition = 7,
         community.too.isolated = 8,
         employer.flexibility = 9,
         too.many.runs = 10,
         too.few.runs = 11,
         dissatisfaction.owner = 12,
         dissatisfaction.manager = 13,
         dissatisfaction.duties = 14) %>%
  gather(key = "obstacles", value = "response", 2:14) %>% 
  mutate(response = ifelse(response == "-", "No", "Yes"))
```

<br>

### Retirement

There is a relationship between the size of population served by an agency and whether retirement was an obstacle to retention. 

The smaller the population served by an agency the significantly more likely age-retirements was a barrier to staff retention.

* Less than 2,500: 34 responses (74%) vs. 28 expected (60%)
* 2,500 - 4,999: 37 responses (65%) vs. 36 expected (60%)
* 5,000 - 9,999: 20 responses (67%) vs. 18 expected (60%)
* 10,000 - 14,999: 11 responses (46%) vs. 15 expected (60%)
* Greater than 15,000: 9 responses (35%) vs. 16 expected (60%)

<br>

```{r pop served and retention - retirement}
pop.retention.retirement <- pop.retention.obstacles %>%
  filter(obstacles == "retirement")

CrossTable(pop.retention.retirement$pop, pop.retention.retirement$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Time commitment

There is a relationship between the size of the population served by an agency and  an agency's response to whether excessive time commitment was an obstacle to retainment.

Agencies that serve a smaller to moderate size population were significantly more likely to respond that the time commitment was a barrier to staff retention.

* Less than 2,500: 37 responses (80%) vs. 33 expected (72%)
* 2,500 - 4,999: 47 responses (83%) vs. 41 expected (72%)
* 5,000 - 9,999: 25 responses (83%) vs. 22 expected (72%)
* 10,000 - 14,999: 15 responses (63%) vs. 17 expected (72%)
* Greater than 15,000: 9 responses (35%) vs. 19 expected (72%)


<br>

```{r pop served and retention - time committment}
pop.retention.time.commit <- pop.retention.obstacles %>%
  filter(obstacles == "time.committment")

CrossTable(pop.retention.time.commit$pop, pop.retention.time.commit$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Difficult to maintain certification

There is no relationship between the size of the population served by an agency and whether an agency indicated that difficulty to maintain certification was an obstacle to retainment.

<br>

```{r pop served and retention - maintain certification}
pop.retention.maintain.certification <- pop.retention.obstacles %>%
  filter(obstacles == "certification.maintain")

CrossTable(pop.retention.maintain.certification$pop, pop.retention.maintain.certification$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Inadequate pay

There is no relationship between the size of the population served by an agency and whether an agency indicated that inadequate pay was an obstacle to retainment.

<br>

```{r pop served and retention - inadequate pay}
pop.retention.inadequate.pay <- pop.retention.obstacles %>%
  filter(obstacles == "inadequate.pay")

CrossTable(pop.retention.inadequate.pay$pop, pop.retention.inadequate.pay$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Limited advancement

There is a  relationship between the size of the population served by an agency and whether an agency indicated that limited advancement opportunities was an obstacle to staff retainment.

The larger the population served by an agency the significantly more likely that limited advancement was a barrier to staff retention.

* Less than 2,500: 0 responses (0%) vs. 11 expected (23%)
* 2,500 - 4,999: 5 responses (9%) vs. 13 expected (23%)
* 5,000 - 9,999: 9 responses (30%) vs. 7 expected (23%)
* 10,000 - 14,999: 12 responses (50%) vs. 6 expected (23%)
* Greater than 15,000: 16 responses (62%) vs. 6 expected (23%)

<br>

```{r pop served and retention - limited advancement opportunities}
pop.retention.limited.advancement <- pop.retention.obstacles %>%
  filter(obstacles == "limited.advancement")

CrossTable(pop.retention.limited.advancement$pop, pop.retention.limited.advancement$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Lack of recognition

There is no relationship between the size of the population served by an agency and whether an agency indicated lack of recognition was an obstacle to retainment.

<br>

```{r pop served and retention - lack of recognition}
pop.retention.recognition <- pop.retention.obstacles %>%
  filter(obstacles == "lack.recognition")

CrossTable(pop.retention.recognition$pop, pop.retention.recognition$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Community is too isolated

There is no relationship between the size of the population served by an agency and whether an agency indicated that the community is too isolated and acts as an obstacle to staff retainment.

<br>

```{r pop served and retention - isolated community}
pop.retention.isolated.community <- pop.retention.obstacles %>%
  filter(obstacles == "community.too.isolated")

CrossTable(pop.retention.isolated.community$pop, pop.retention.isolated.community$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Employer won't allow staff to leave work

There is a relationship between the size of a population served by an agency and whether an agency indicated that employers not allowing staff to respond to calls during work hours was an obstacle to staff retainment.

Agencies that serve a moderate size population (~5,000 - 10,000) were significantly more likely to say that employers not allowing staff to leave work was a barrier to staff retention.

* Less than 2,500: 16 responses (35%) vs. 17 expected (37%)
* 2,500 - 4,999: 28 responses (49%) vs. 22 expected (37%)
* 5,000 - 9,999: 18 responses (60%) vs. 11 expected (37%)
* 10,000 - 14,999: 6 responses (25%) vs. 9 expected (37%)
* Greater than 15,000: 1 responses (4%) vs. 10 expected (37%)

<br>

```{r pop served and retention - employer flexibility}
pop.retention.employer.flexibility <- pop.retention.obstacles %>%
  filter(obstacles == "employer.flexibility")

CrossTable(pop.retention.employer.flexibility$pop, pop.retention.employer.flexibility$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Too many runs

There is no relationship between the size of population served by an agency and whether an agency indicated that too many runs or transports was an obstacle in retainment.

<br>

```{r pop served and retention - too many runs}
pop.retention.too.many.runs <- pop.retention.obstacles %>%
  filter(obstacles == "too.many.runs")

CrossTable(pop.retention.too.many.runs$pop, pop.retention.too.many.runs$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Too few runs

There is no relationship between the size of population served by an agency and an agency's response to whether too few runs or transports was an obstacle in staff retainment.

<br>

```{r pop served and retention - too few runs}
pop.retention.too.few.runs <- pop.retention.obstacles %>%
  filter(obstacles == "too.few.runs")

CrossTable(pop.retention.too.few.runs$pop, pop.retention.too.few.runs$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Dissastisfaction with EMS owners

There is no relationship between the size of population served by an agency and an agency's response to whether dissatisfaction with ownership was an obstacle to retainment.

<br>

```{r pop served and retention - dissatisfaction with owners}
pop.retention.dissatisfaction.owners <- pop.retention.obstacles %>%
  filter(obstacles == "dissatisfaction.owner")

CrossTable(pop.retention.dissatisfaction.owners$pop, pop.retention.dissatisfaction.owners$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Dissatisfaction with EMS manager

There is no relationship between the size of population served by an agency and an agency's response to whether dissatisfaction was an obstacle to staff retainment.

<br>

```{r pop served and retention - dissatisfaction with manager}
pop.retention.dissat.manager <- pop.retention.obstacles %>%
  filter(obstacles == "dissatisfaction.manager")

CrossTable(pop.retention.dissat.manager$pop, pop.retention.dissat.manager$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>


### Dissatisfaction with job duties

There is no relationship between the size of population served by an agency and an agency's response to whether dissatisfaction with job duties is an obstacle to staff retainment.

<br>

```{r pop served and retention - dissatisfaction with job duties}
pop.retention.dissat.duties <- pop.retention.obstacles %>%
  filter(obstacles == "dissatisfaction.duties")

CrossTable(pop.retention.dissat.duties$pop, pop.retention.dissat.duties$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>


# Leadership section analysis{.tabset}

The questions where the size of the population served by an agency had a relationship in how an agency responded to the questions in the leadership section of the survey are summarized below.

**Summary:**

The leadership section questions that had a relationship with the size of the population served by an agency are listed below.

*Leaders have training:* 
As the size of the population increases the likelihood that the EMS manager has received training increases significantly.

*Challenges to management areas: *
The challenge areas with a relationship were;

* Recruitment: Agencies that serve a moderate to small sized populations were significantly more likely to say that recruitment was a challenging management area.
* Retention: Agencies that serve a moderately sized population (2,500 - 10,000) were significantly more likely to say that retention was a management challenge area.
* Staffing schedule: Agencies that serve a moderately sized population (2,500 - 10,000) were significantly more likely to say that staffing the schedule was a management challenge area.
* None: As the population served increases so does the likelihood that an agency responded there were "none" management challenge areas.

<br>
 
**Analysis:**

The questions in the leadership section of the survey are provided in tabs below along with the chi-square and p-value for the relationship between region and each question.

<br>

## Leaders have training?

**Has the EMS manager of your agency had formal leadership or management training?**

Respondents were provided two choices which are listed below in order of top choice first;

* Yes (54%)
* No (46%)

There is a relationship between the size of population served by an agency and whether an agency indicated their managers received leadership and or management training.

As the size of the population increased so did the likeliness that an agency's director had received training.

* Less than 2,500: 17 responses (38%) vs. 24 expected (54%)
* 2,500 - 4,999: 24 responses (42%) vs. 31 expected (54%)
* 5,000 - 9,999: 17 responses (57%) vs. 16 expected (54%)
* 10,000 - 14,999: 15 responses (65%) vs. 12 expected (54%)
* Greater than 15,000: 24 responses (92%) vs. 14 expected (54%)


<br>

```{r pop served and leadership training}
pop.leadership.training <- master.responses %>%
  select(3, 58) %>%
  rename(leadership.training = 2)

CrossTable(pop.leadership.training$pop, pop.leadership.training$leadership.training, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

**Has your agency had three or more managers in the past five years?**

Respondents were provided two choices which are listed below in order of top choice first;

* No (86%)
* Yes (13%)

There is no relationship between the size of the population served by an agency and how an agency responded to management turnover.

<br>

```{r pop served support and leadership turnover}
pop.leadership.turnover <- master.responses %>%
  select(3, 59) %>%
  rename(leadership.turnover = 2)

CrossTable(pop.leadership.turnover$pop, pop.leadership.turnover$leadership.turnover, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

## Challenges to management areas{.tabset .tabset-pills}

**Which areas are most difficult to manage?**

Respondents were provided 13 choices and were told to check all that apply. The choices are listed below in order of top choice first;

* Recruitment (69%)
* Staffing the schedule (51%)
* Retention (43%)
* Continuing education requirements (32%)
* Managing staff (31%)
* Policy development and enforcement (25%)
* Staff certification (20%)
* Budget development (17%)
* Billing and reimbursement (15%)
* Maintaining equipment (11%)
* Medical direction (10%)
* None (9%)
* Licensing requirements for the ambulance (5%)

The management challenge areas that had a relationship with the size of the population served by an agency were;

* Recruitment
* Retention
* Staffing schedule
* None (no management challenge areas)


<br>

```{r prep pop served and leadership challenge areas}
pop.leadership.challenges <- master.responses %>%
  select(3, 60:74) %>%
  rename(recruitment = 2,
         retention = 3,
         budget = 4,
         staff = 5,
         staffing.schedule = 6,
         medical.direction = 7,
         education.requirements = 8,
         equipment = 9,
         billing = 10,
         licensing = 11,
         staff.certification = 12,
         technology = 13,
         policy = 14,
         technology.2 = 15,
         none = 16) %>%
  gather(key = "challenges", value = "response", 2:16) %>%
  mutate(challenges = str_replace(challenges, "technology.2", "technology"),
         response = ifelse(response == "-", "No", "Yes"))
```

<br>

### Recruitment

There is a relationship between the size of the population served by an an agencies response to recruitment being a management challenge.

Agencies that serve small and moderate populations (Less than 2,500 - 10,000) were significantly more likely to say that recruitment was a management problem.

* Less than 2,500: 33 responses (72%) vs. 32 expected (69%)
* 2,500 - 4,999: 48 responses (84%) vs. 39 expected (69%)
* 5,000 - 9,999: 23 responses (77%) vs. 21 expected (69%)
* 10,000 - 14,999: 12 responses (52%) vs. 16 expected (69%)
* Greater than 15,000: 10 responses (39%) vs. 18 expected (69%)

<br>

```{r pop served and leadership challenge areas - recruitment}
pop.leadership.challenges.recruitment <- pop.leadership.challenges %>%
  filter(challenges == "recruitment")

CrossTable(pop.leadership.challenges.recruitment$pop, pop.leadership.challenges.recruitment$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Retention

There is a relationship between the size of the population served by an agency and an agency's response to retention being a management challenge area.

Agencies that serve a moderately sized populations (2,500 - 10,000) were significantly more likely to say that retention was a management challenge area.

* Less than 2,500: 16 responses (35%) vs. 20 expected (43%)
* 2,500 - 4,999: 29 responses (51%) vs. 24 expected (43%)
* 5,000 - 9,999: 18 responses (60%) vs. 13 expected (43%)
* 10,000 - 14,999: 11 responses (48%) vs. 10 expected (43%)
* Greater than 15,000: 4 responses (15%) vs. 11 expected (43%)

<br>

```{r pop served and leadership challenge areas - retention}
pop.leadership.challenges.retention <- pop.leadership.challenges %>%
  filter(challenges == "retention")

CrossTable(pop.leadership.challenges.retention$pop, pop.leadership.challenges.retention$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Budget

There is no relationship between the size of the population served by an agency and whether an agency identified budget development as a management challenge area.

<br>

```{r pop served and leadership challenge areas - budget}
pop.leadership.challenges.budget <- pop.leadership.challenges %>%
  filter(challenges == "budget")

CrossTable(pop.leadership.challenges.budget$pop, pop.leadership.challenges.budget$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Managing staff

There is no relationship between the size of the population served by an agency and whether an agency identified managing staff as a management challenge area.

<br>

```{r pop served and leadership challenge areas - manageing staff}
pop.leadership.challenges.staff <- pop.leadership.challenges %>%
  filter(challenges == "staff")

CrossTable(pop.leadership.challenges.staff$pop, pop.leadership.challenges.staff$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Staffing schedule

There is a relationship between the size of the population served by an agency and whether an agency identified staffing schedule as an management challenge area.

Agencies that serve moderately sized populations (2,500 - 10,000) were significantly more likely to say that staffing the schedule was a management challenge area.

* Less than 2,500: 21 responses (46%) vs. 23 expected (51%)
* 2,500 - 4,999: 35 responses (61%) vs. 29 expected (51%)
* 5,000 - 9,999: 21 responses (70%) vs. 15 expected (51%)
* 10,000 - 14,999: 8 responses (35%) vs. 12 expected (51%)
* Greater than 15,000: 6 responses (23%) vs. 13 expected (51%)

<br>

```{r pop served and leadership challenge areas - staffing schedule}
pop.leadership.challenges.staffing.schedule <- pop.leadership.challenges %>%
  filter(challenges == "staffing.schedule")

CrossTable(pop.leadership.challenges.staffing.schedule$pop, pop.leadership.challenges.staffing.schedule$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Medical direction

There is no relationship between the size of the population served by an agency and how an agency responded to medical direction as a management challenge area.

<br>

```{r pop served and leadership challenge areas - medical direction}
pop.leadership.challenges.medical.direction <- pop.leadership.challenges %>%
  filter(challenges == "medical.direction")

CrossTable(pop.leadership.challenges.medical.direction$pop, pop.leadership.challenges.medical.direction$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Education requirements

There is no relationship between the size of the population served by an agency and whether an agency indicated that keeping up with education requirements was a management challenge area.

<br>

```{r pop served and leadership challenge areas - education requirements}
pop.leadership.challenges.education.req <- pop.leadership.challenges %>%
  filter(challenges == "education.requirements")

CrossTable(pop.leadership.challenges.education.req$pop, pop.leadership.challenges.education.req$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Equipment

There is no relationship between the size of the population served by an agency and whether an agency indicated that updating equipment was a management challenge.

<br>

```{r pop served and leadership challenge areas - equipment}
pop.leadership.challenges.equipment <- pop.leadership.challenges %>%
  filter(challenges == "equipment")

CrossTable(pop.leadership.challenges.equipment$pop, pop.leadership.challenges.equipment$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Billing

There is no relationship between the size of the population served by an agency and whether an agency indicated that billing and reimbursement was a management challenge area.

<br>

```{r pop served and leadership challenge areas - billing}
pop.leadership.challenges.billing <- pop.leadership.challenges %>%
  filter(challenges == "billing")

CrossTable(pop.leadership.challenges.billing$pop, pop.leadership.challenges.billing$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Licensing

There is no relationship between the size of the population served by an agency and whether an agency indicated that licensing was a management challenge area.

<br>

```{r pop served and leadership challenge areas - licensing}
pop.leadership.challenges.licensing <- pop.leadership.challenges %>%
  filter(challenges == "licensing")

CrossTable(pop.leadership.challenges.licensing$pop, pop.leadership.challenges.licensing$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Staff certficiation

There is no relationship between the size of the population served by an agency and whether an agency indicated that keeping up on staff certification was a management challenge area.

<br>

```{r pop served and leadership challenge areas - staff certification}
pop.leadership.challenges.staff.certification <- pop.leadership.challenges %>%
  filter(challenges == "staff.certification")

CrossTable(pop.leadership.challenges.staff.certification$pop, pop.leadership.challenges.staff.certification$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Technology updates

There is no relationship between the size of the population served by an agency and whether an agency indicated that maintaining technology was a management challenge area.

<br>

```{r pop served and leadership challenge areas - technology}
pop.leadership.challenges.technology <- pop.leadership.challenges %>%
  filter(challenges == "technology")

CrossTable(pop.leadership.challenges.technology$pop, pop.leadership.challenges.technology$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### Policy and enforcement

There is no relationship between the size of the population served by an agency and whether an agency indicated that policy and enforcement was a management challenge area.

<br>

```{r pop served and leadership challenge areas - policy}
pop.leadership.challenges.policy <- pop.leadership.challenges %>%
  filter(challenges == "policy")

CrossTable(pop.leadership.challenges.policy$pop, pop.leadership.challenges.policy$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

### None

There is a relationship between the size of the population served by an agency and whether an agency indicated that there were no management challenge areas.

As the population served increases so does the likelihood that an agency responded there were "none" management areas.

* Less than 2,500: 2 responses (4%) vs. 4 expected (9%)
* 2,500 - 4,999: 3 responses (5%) vs. 5 expected (9%)
* 5,000 - 9,999: 0 responses (0%) vs. 3 expected (9%)
* 10,000 - 14,999: 4 responses (17%) vs. 2 expected (9%)
* Greater than 15,000: 7 responses (27%) vs. 2 expected (9%)

<br>

```{r pop served and leadership challenge areas - none}
pop.leadership.challenges.none <- pop.leadership.challenges %>%
  filter(challenges == "none")

CrossTable(pop.leadership.challenges.none$pop, pop.leadership.challenges.none$response, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)
```

<br>

## Shift Coverage

**What percent of your shifts are fully covered at least 24 hours in advance?**

Respondents were provided 5 choices which are provided below with the top choice listed first;

* 75% - 99% (43%)
* 100% (41%)
* 25% - 49% (3%)
* 0% - 24% (2%)

<br>

There is no relationship between the size of the population served by an agency and how an agency responded to the percentage of shifts covered 24 hours in advance.



```{r pop served percent shifts covered}
pop.shifts.covered <- master.responses %>%
  select(3,75) %>%
  rename(pct.shifts.covered = 2)

CrossTable(pop.shifts.covered$pop, pop.shifts.covered$pct.shifts.covered, expected = TRUE, prop.t = FALSE, prop.c = FALSE, prop.chisq = FALSE)

```

<br>

